(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();class U{constructor(){this.ships=[],this.missedAttacks=[],this.attackedCoordinates=[],this.size=this.createBoard()}createBoard(){const e=[1,2,3,4,5,6,7,8,9,10];let t=[];for(const a of e)for(let s=1;s<=e.length;s++)t.push([a,s]);return t}placeShip(e,t,a){let s=[],o=[];const[l,i]=t;for(let n=0;n<e.length;n++)a==="horizontally"?o.push([l,i+n]):a==="vertically"&&o.push([l+n,i]);for(const n of o)if(n[0]>10||n[1]>10)return"You can't position ships outside the map!";for(const n of this.ships)for(const c of n.coordinates)if(o.some(d=>d[0]===c[0]&&d[1]===c[1]))return"You can't position ships on top of each other!";return s=o,this.ships.push({ship:e,coordinates:s}),s}receiveAttack(e){if(this.attackedCoordinates.some(s=>s[0]===e[0]&&s[1]===e[1]))return alert("You cant attack same coordinate twice!");this.attackedCoordinates.push(e);let a=!1;for(const s of this.ships)s.coordinates.some(o=>o[0]===e[0]&&o[1]===e[1])&&(s.ship.hit(),a=!0);a===!1&&this.missedAttacks.push(e)}areAllShipsSunk(){for(const{ship:e}of this.ships)if(e.isSunk()!=!0)return!1;return!0}}class I{constructor(e){this.type=e,this.gameboard=new U,this.score=Number(localStorage.getItem(`${e}Score`))||0}makeMove(e,t){return t.gameboard.receiveAttack(e)}makeRandomMove(e){let t,a;do t=Math.floor(Math.random()*10)+1,a=Math.floor(Math.random()*10)+1;while(e.gameboard.attackedCoordinates.some(s=>s[0]===t&&s[1]===a));return e.gameboard.receiveAttack([t,a]),[t,a]}getRandomMove(){let e=[];const t=Math.floor(Math.random()*10)+1,a=Math.floor(Math.random()*10)+1;return e.push(t,a),e}}const $="/battleships/assets/Battleship-Qz7ibCrf.png",M="/battleships/assets/Carrier-B8Cev5xA.png",k="/battleships/assets/Cruiser-CUujuxrM.png",P="/battleships/assets/PatrolBoat-BdNml_Z2.png",A="/battleships/assets/Cruiser-CUujuxrM.png";class y{constructor(e){this.name=e,this.hits=0}hit(e=1){this.hits+=e,this.isSunk()}isSunk(){return this.hits>=this.length?(console.log(`${this.name} is sunk!`),!0):!1}}class T extends y{constructor(){super("Carrier"),this.length=5}}class z extends y{constructor(){super("Battleship"),this.length=4}}class R extends y{constructor(){super("Crusier"),this.length=3}}class O extends y{constructor(){super("Submarine"),this.length=3}}class H extends y{constructor(){super("Patrol Boat"),this.length=2}}let L=null,v=[];function N(r){v.forEach(e=>{if(!r.includes(e)){const t=document.getElementById(e);t&&!t.classList.contains("bg-green-400")&&(t.classList.remove("bg-green-200"),t.classList.add("bg-white","hover:bg-blue-200"))}}),r.forEach(e=>{const t=document.getElementById(e);t&&!t.classList.contains("bg-green-400")&&(t.classList.remove("bg-white","hover:bg-blue-200"),t.classList.add("bg-green-200"))}),v=r}function q(){const r=document.getElementById("game-window");r.className="flex flex-col min-h-screen md:flex-row flex-col w-full h-full";const e=document.createElement("div");e.id="player-window",e.className="flex flex-col w-full h-full  items-center pt-20",r.appendChild(e),e.innerHTML=`
    <h2 class="text-2xl font-bold mb-4 text-indigo-500">Player</h2>
    <div id="available-ships-window-p" class="grid grid-cols-2 gap-4 w-3/4 lg:w-2/4 h-64 border-10 border-indigo-500 rounded-xl"></div>
    <div id="player-board"></div>
  `;const t=document.createElement("div");t.id="computer-window",t.className="flex flex-col w-full h-full items-center pt-20",r.appendChild(t),t.innerHTML=`
    <h2 class="text-2xl font-bold mb-4 text-rose-700">Computer</h2>
    <div id="available-ships-window-c" class="grid grid-cols-2 gap-4  w-3/4 lg:w-2/4 h-64 border-10 border-rose-700 rounded-xl"></div>
    <div id="computer-board"></div>
  `;const a=document.getElementById("available-ships-window-p"),s=document.getElementById("available-ships-window-c");a.innerHTML=`
    <img src="${M}" alt="Carrier" class="h-16 w-64" draggable="true" data-ship="carrier" data-size="5" id="carrier">
    <img src="${$}" alt="Battleship" class="h-16 w-64" draggable="true" data-ship="battleship" data-size="4" id="battleship">
    <img src="${k}" alt="Cruiser" class="h-16 w-64" draggable="true" data-ship="cruiser" data-size="3" id="cruiser">
    <img src="${A}" alt="Submarine" class="h-16 w-64" draggable="true" data-ship="submarine" data-size="3" id="submarine">
    <img src="${P}" alt="Patrol Boat" class="h-16 w-64" draggable="true" data-ship="patrolboat" data-size="2" id="patrolboat">
  `,s.innerHTML=`
    <img src="${M}" alt="Carrier" class="h-16 w-64">
    <img src="${$}" alt="Battleship" class="h-16 w-64">
    <img src="${k}" alt="Cruiser" class="h-16 w-64">
    <img src="${A}" alt="Submarine" class="h-16 w-64">
    <img src="${P}" alt="Patrol Boat" class="h-16 w-64">
  `;const o=document.getElementById("player-board");o.className="flex grid grid-cols-10 gap-0 p-10";for(let i=0;i<10;i++)for(let n=0;n<10;n++){const c=document.createElement("div");c.id=`[p: ${i+1}, ${n+1}]`,c.className="flex border-2 border-black min-w-[32px] min-h-[32px] lg:min-w-[54px] lg:min-h-[54px] bg-white hover:bg-blue-200",K(c),o.appendChild(c)}const l=document.getElementById("computer-board");l.className="grid grid-cols-10 gap-0 p-10";for(let i=0;i<10;i++)for(let n=0;n<10;n++){const c=document.createElement("div");c.id=`[c: ${i+1}, ${n+1}]`,c.className="flex border-2 border-black min-w-[32px] min-h-[32px] lg:min-w-[54px] lg:min-h-[54px] bg-white hover:bg-blue-200",l.appendChild(c)}F(a)}function F(r){r.addEventListener("dragstart",e=>{const t=e.target.getAttribute("data-ship"),a=e.target.getAttribute("data-size");e.dataTransfer.setData("ship",t),e.dataTransfer.setData("size",a),L={name:t,size:parseInt(a,10)}})}function K(r){r.addEventListener("dragover",e=>{if(e.preventDefault(),!L)return;const t=r.id.split(":")[1].split(","),a=parseInt(t[0].trim()),s=parseInt(t[1].replace("]","").trim());let o=[];for(let l=0;l<L.size;l++){const i=s+l,n=`[p: ${a}, ${i}]`;o.push(n)}N(o)}),r.addEventListener("drop",e=>{e.preventDefault();const t=m.getPlayer(),a=t.gameboard,s=e.dataTransfer.getData("ship"),o=parseInt(e.dataTransfer.getData("size"),10),l=r.id.split(":")[1].split(","),i=parseInt(l[0].trim()),n=parseInt(l[1].replace("]","").trim()),c=[];for(let f=0;f<o;f++)c.push([i,n+f]);const S={carrier:T,battleship:z,cruiser:R,submarine:O,patrolboat:H}[s.toLowerCase()],u=new S,g=a.placeShip(u,[i,n],"horizontally");if(g==="You can't position ships outside the map!"||g==="You can't position ships on top of each other!"){alert("Invalid placement! Try again.");return}c.forEach(([f,G])=>{const X=`[p: ${f}, ${G}]`,E=document.getElementById(X);E&&(E.classList.remove("bg-white","hover:bg-blue-200","bg-green-200"),E.classList.add("bg-green-400"))});const w=document.getElementById(s);w&&w.parentNode&&w.parentNode.removeChild(w),N([]),t.gameboard.ships.length===5&&m.battleStart()})}document.addEventListener("dragend",()=>{v.forEach(r=>{const e=document.getElementById(r);e&&!e.classList.contains("bg-green-400")&&(e.classList.remove("bg-green-200"),e.classList.add("bg-white","hover:bg-blue-200"))}),v=[]});function Q(r,e){const t=document.createElement("div");t.id="player-scoreboard",t.className="text-lg",t.innerHTML=`
    <h2 class="text-2xl font-bold mb-4">Player Scoreboard</h2>
    <p>Ships Remaining: ${r.gameboard.ships.length}</p>
    <p>Score: ${r.score}</p>
  `,document.getElementById("player-window").appendChild(t);const a=document.createElement("div");a.id="computer-scoreboard",a.className="text-lg",a.innerHTML=`
    <h2 class="text-2xl font-bold mb-4">Computer Scoreboard</h2>
    <p>Ships Remaining: ${e.gameboard.ships.length}</p>
    <p>Score: ${e.score}</p>
  `,document.getElementById("computer-window").appendChild(a)}function Z(r){return new Promise(e=>{const[t,a]=r,s=`[p: ${t}, ${a}]`,o=document.getElementById(s);if(!o){console.error(`Cell ${s} not found`),e(!1);return}const l=m.getPlayer().gameboard.ships.some(i=>i.coordinates.some(n=>n[0]===t&&n[1]===a));o.classList.remove("bg-white","hover:bg-blue-200"),o.classList.add(l?"bg-red-500":"bg-blue-500"),e(!0)})}function _(r){return new Promise(e=>{const t=document.getElementById("computer-board"),a=t.cloneNode(!0);t.parentNode.replaceChild(a,t);for(let s=1;s<=10;s++)for(let o=1;o<=10;o++){const l=`[c: ${s}, ${o}]`,i=document.getElementById(l);i&&i.addEventListener("click",n=>{const c=s,d=o;if(r.gameboard.attackedCoordinates.some(u=>u[0]===c&&u[1]===d)){alert("You already attacked this position!");return}r.gameboard.receiveAttack([c,d]);const S=r.gameboard.ships.some(u=>u.coordinates.some(g=>g[0]===c&&g[1]===d));i.classList.remove("bg-white","hover:bg-blue-200"),i.classList.add(S?"bg-red-500":"bg-blue-500"),e(!0)})}})}function J(){const r=m.getPlayer(),e=m.getComputer(),t=document.getElementById("player-scoreboard"),a=document.getElementById("computer-scoreboard");t&&a&&(t.innerHTML=`
            <h2 class="text-2xl font-bold mb-4">Player Scoreboard</h2>
            <p>Ships Remaining: ${r.gameboard.ships.length}</p>
            <p>Score: ${r.score}</p>
        `,a.innerHTML=`
            <h2 class="text-2xl font-bold mb-4">Computer Scoreboard</h2>
            <p>Ships Remaining: ${e.gameboard.ships.length}</p>
            <p>Score: ${e.score}</p>
        `)}const x={InitialRender:q,addScoreboardDOM:Q,handleReceiveAttackPlayer:Z,handleReceiveAttackComputer:_,updateScoreboard:J};let h,p,C="player",b=!1;function V(){h=new I("human"),p=new I("computer"),C="player",b=!1}function D(){return h}function Y(){return p}async function ee(){console.log("Battle started!"),se(p),x.addScoreboardDOM(D(),Y()),W()}function W(){b||C==="player"&&x.handleReceiveAttackComputer(p).then(r=>{p.gameboard.areAllShipsSunk()?(b=!0,h.score++,re(h.score),j("Player")):(C="computer",te())})}function te(){if(b)return;const r=p.makeRandomMove(h);x.handleReceiveAttackPlayer(r).then(()=>{h.gameboard.areAllShipsSunk()?(b=!0,p.score++,ae(p.score),j("Computer")):(C="player",W())})}function se(r){[{shipClass:T},{shipClass:z},{shipClass:R},{shipClass:O},{shipClass:H}].forEach(t=>{let a=!1;const s=t.shipClass,o=new s,l="horizontally";for(;!a;){const i=Math.floor(Math.random()*10)+1,n=Math.floor(Math.random()*10)+1,c=[i,n];let d=r.gameboard.placeShip(o,c,l);d==="You can't position ships outside the map!"||d==="You can't position ships on top of each other!"?a=!1:a=!0}})}function j(r){const e=document.createElement("div");e.className="fixed top-0 left-0 w-full h-full bg-black bg-opacity-50 flex flex-col items-center justify-center text-white text-4xl z-50",e.innerHTML=`
        <h1>${r} Wins!</h1>
        <p class="text-2xl mt-4">Player Score: ${h.score} - Computer Score: ${p.score}</p>
        <button class="mt-4 bg-blue-500 text-white px-4 py-2 rounded text-2xl" id="play-again">
            Play Again
        </button>
    `,document.body.appendChild(e),document.getElementById("play-again").addEventListener("click",()=>{location.reload()})}function re(r){localStorage.setItem(`${h.type}Score`,r)}function ae(r){localStorage.setItem(`${p.type}Score`,r)}const m={startGame:V,getPlayer:D,getComputer:Y,battleStart:ee},oe=document.getElementById("start-button"),B=document.getElementById("game-window");oe.addEventListener("click",()=>{for(;B.firstChild;)B.removeChild(B.firstChild);x.InitialRender(),m.startGame()});
